!function(t){var i={};function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(n,s,function(i){return t[i]}.bind(null,s));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="/dist/",e(e.s=1)}([function(t,i,e){},function(t,i,e){"use strict";e.r(i);e(0);function n(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return s(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return s(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.dimensions=i}var i,e,s;return i=t,(e=[{key:"drawBackground",value:function(t){t.fillStyle="rgb(235, 220, 235)",t.fillRect(0,0,this.dimensions.width,this.dimensions.height);var i=[166,166],e=[this.dimensions.width-150-16,this.dimensions.height-150-16],s=[this.dimensions.width-300-32,this.dimensions.height-300-32];t.rect.apply(t,i.concat(s));var r=t.createRadialGradient(this.dimensions.width/2,this.dimensions.height/2,5,this.dimensions.width/2,this.dimensions.height/2,300);r.addColorStop(0,"lightgreen"),r.addColorStop(1,"green"),t.fillStyle=r,t.fill(),t.lineWidth=32,t.strokeStyle="rgb(203, 113, 33)",t.strokeRect.apply(t,i.concat(s)),this.innerBorders||(this.innerBorders=[[[182,203],[182,this.dimensions.height-150-32-21],[198,this.dimensions.height-150-32-16-21],[198,219]],[[this.dimensions.width-150-32,203],[this.dimensions.width-150-32,this.dimensions.height-150-32-21],[this.dimensions.width-150-32-16,this.dimensions.height-150-32-16-21],[this.dimensions.width-150-32-16,219]],[[203,182],[.5*this.dimensions.width-14,182],[.5*this.dimensions.width-14-16,198],[219,198]],[[this.dimensions.width-150-32-21,182],[.5*this.dimensions.width+14,182],[.5*this.dimensions.width+14+16,198],[this.dimensions.width-150-32-21-16,198]],[[203,this.dimensions.height-150-32],[.5*this.dimensions.width-14,this.dimensions.height-150-32],[.5*this.dimensions.width-14-16,this.dimensions.height-150-32-16],[219,this.dimensions.height-150-32-16]],[[this.dimensions.width-150-32-21,this.dimensions.height-150-32],[.5*this.dimensions.width+14,this.dimensions.height-150-32],[.5*this.dimensions.width+14+16,this.dimensions.height-150-32-16],[this.dimensions.width-150-32-21-16,this.dimensions.height-150-32-16]]]),this.innerBorders.forEach((function(i){t.beginPath(),t.moveTo.apply(t,n(i[0])),t.lineTo.apply(t,n(i[1])),t.lineTo.apply(t,n(i[2])),t.lineTo.apply(t,n(i[3])),t.closePath(),t.fillStyle="yellowgreen",t.fill()}));var o=[[i[0]+24,i[1]+24,15],[i[0]+24,e[1]-24,15],[e[0]-24,i[1]+24,15],[e[0]-24,e[1]-24,15]];t.fillStyle="black",o.forEach((function(i){t.beginPath(),t.arc.apply(t,n(i).concat([0,2*Math.PI])),t.fill()}));var h=[[(i[0]+e[0])/2,i[1]+20.8-4.2,14],[(i[0]+e[0])/2,e[1]-20.8+4.2,14]];h.forEach((function(i){t.beginPath(),t.arc.apply(t,n(i).concat([0,2*Math.PI])),t.fill()})),this.pocketCenters||(this.pocketCenters=o.concat(h))}},{key:"animate",value:function(t){this.drawBackground(t)}}])&&r(i.prototype,e),s&&r(i,s),t}();function h(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=8.5,l="gray",c=5e-6,d=function(){function t(i,e,n,s,r){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.vx=e.x,this.vy=e.y,this.x=i.x,this.y=i.y,this.number=n,this.color=s,this.marking=r,this.colliding=!1}var i,e,n;return i=t,(e=[{key:"intersect",value:function(t){return(this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y)<=4*a*a}},{key:"drawBall",value:function(t){"solid"!==this.marking&&this.marking?"striped"===this.marking&&(t.fillStyle="white",t.beginPath(),t.arc(this.x,this.y,a,0,2*Math.PI),t.fill(),t.lineWidth=.5,t.strokeStyle=l,t.stroke(),t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,a,-Math.PI/6,Math.PI/6),t.lineTo(this.x-a*Math.sqrt(3)/2,this.y-a/2),t.closePath(),t.fill(),t.beginPath(),t.arc(this.x,this.y,a,Math.PI-Math.PI/6,Math.PI+Math.PI/6),t.lineTo(this.x+a*Math.sqrt(3)/2,this.y+a/2),t.closePath(),t.fill()):(t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,a,0,2*Math.PI),t.fill(),t.lineWidth=.5,t.strokeStyle=l,t.stroke()),this.number&&(t.fillStyle="white",t.beginPath(),t.arc(this.x,this.y,.6*a,0,2*Math.PI),t.fill(),t.font="bold 8px sans-serif",t.textAlign="center",t.fillStyle="black",t.fillText(this.number,this.x,this.y+2.5))}},{key:"move",value:function(){this.x+=this.vx,this.y+=this.vy;var t=Math.sqrt(this.vx*this.vx+this.vy*this.vy);if(t>.001){var i={x:this.vx/t,y:this.vy/t};Math.abs(this.vx)>Math.abs(i.x*c)?this.vx-=i.x*c:this.vx=0,Math.abs(this.vy)>Math.abs(i.y*c)?this.vy-=i.y*c:this.vy=0}else this.vx=0,this.vy=0}},{key:"animate",value:function(t){this.drawBall(t)}}])&&h(i.prototype,e),n&&h(i,n),t}();function u(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return m(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return m(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function y(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=[{number:null,color:"white",marking:null},{number:1,color:"yellow",marking:"solid"},{number:2,color:"blue",marking:"solid"},{number:3,color:"red",marking:"solid"},{number:4,color:"purple",marking:"solid"},{number:5,color:"orange",marking:"solid"},{number:6,color:"green",marking:"solid"},{number:7,color:"brown",marking:"solid"},{number:8,color:"black",marking:"solid"},{number:9,color:"yellow",marking:"striped"},{number:10,color:"blue",marking:"striped"},{number:11,color:"red",marking:"striped"},{number:12,color:"purple",marking:"striped"},{number:13,color:"orange",marking:"striped"},{number:14,color:"green",marking:"striped"},{number:15,color:"brown",marking:"striped"}],p=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvas=i,this.ctx=i.getContext("2d"),this.dimensions={width:i.width,height:i.height},this.innerTopLeft=[190,190],this.innerBottomRight=[this.dimensions.width-150-32-8,this.dimensions.height-150-32-8],this.innerWidthHeight=[this.dimensions.width-300-64-16,this.dimensions.height-300-64-16],this.pocketedBalls={striped:[],solid:[]},this.currentPocketed=[],this.playerOne={id:1,marking:null},this.playerTwo={id:2,marking:null},this.currentPlayer=this.playerOne,this.gameStatus=null,this.newGame=!0,this.scratched=null,this.handleMouseMove=this.handleMouseMove.bind(this),this.handleClick=this.handleClick.bind(this)}var i,e,n;return i=t,(e=[{key:"animate",value:function(){var t=this;this.table.animate(this.ctx);for(var i=0;i<50;i++)this.poolBalls.forEach((function(i){i.move(t.ctx)})),this.checkCollisions(),this.checkPocketsAndBoundary();this.poolBalls.forEach((function(i){i.animate(t.ctx)})),this.poolBalls.every((function(t){return 0===t.vx&&0===t.vy}))?(this.running=!1,this.newGame?(this.gameStatus="New game! Player ".concat(this.currentPlayer.id,"'s Turn"),this.newGame=!1,this.takeTurn()):!this.newGame&&this.checkContinueGame()&&this.takeTurn()):this.gameStatus="Pending...",this.drawGameStatus(),this.running&&requestAnimationFrame(this.animate.bind(this))}},{key:"checkContinueGame",value:function(){var t=this,i=!1,e=null,n=0;return this.currentPocketed.forEach((function(s){if(8===s.number)i=!0;else if(s.number)t.pocketedBalls[s.marking].push(s),s.marking===t.currentPlayer.marking&&n++;else{e=s;var r=t.innerTopLeft[1]+.5*t.innerWidthHeight[1],o={x:t.innerTopLeft[0]+.25*t.innerWidthHeight[0],y:r};e.x=o.x,e.y=o.y,e.vx=0,e.vy=0}})),i&&this.currentPlayer.marking?(7!==this.pocketedBalls[this.currentPlayer.marking].length||e?this.gameStatus="Eight ball was pocketed. Player ".concat(this.currentPlayer.id," lost!"):this.gameStatus="Eight ball was pocketed. Player ".concat(this.currentPlayer.id," won!"),!1):i?(this.gameStatus="Eight ball was pocketed. Player ".concat(this.currentPlayer.id," lost!"),!1):(e?(this.poolBalls=[e].concat(this.poolBalls),this.currentPlayer=1===this.currentPlayer.id?this.playerTwo:this.playerOne,this.gameStatus="Scratch. Player ".concat(this.currentPlayer.id,"'s Turn")):0===this.currentPocketed.length||this.scratched?(this.scratched&&(this.scratched=null),this.currentPlayer=1===this.currentPlayer.id?this.playerTwo:this.playerOne,this.gameStatus="Scratch. Player ".concat(this.currentPlayer.id,"'s Turn")):this.currentPlayer.marking?n?this.gameStatus="Player ".concat(this.currentPlayer.id,"'s Turn"):(this.currentPlayer=1===this.currentPlayer.id?this.playerTwo:this.playerOne,this.gameStatus="Scratch. Player ".concat(this.currentPlayer.id,"'s Turn")):(this.currentPlayer.marking=this.currentPocketed[0].marking,(1===this.currentPlayer.id?this.playerTwo:this.playerOne).marking="striped"===this.currentPlayer.marking?"solid":"striped",this.gameStatus="Player ".concat(this.currentPlayer.id,"'s Turn")),this.currentPocketed=[],!0)}},{key:"handleClick",value:function(t){var i=this.canvas.getBoundingClientRect(),e=t.clientX-i.left*(this.canvas.width/i.width),n=t.clientY-i.top*(this.canvas.height/i.height),s=(this.poolBalls[0].x-e)/300,r=(this.poolBalls[0].y-n)/300,o=Math.sqrt(s*s+r*r);o>a/50&&(s=s/o*a/50*.8,r=r/o*a/50*.8),this.poolBalls[0].vx=s,this.poolBalls[0].vy=r,this.canvas.removeEventListener("click",this.handleClick),this.canvas.removeEventListener("mousemove",this.handleMouseMove),this.running||this.play()}},{key:"handleMouseMove",value:function(t){var i=this;this.table.animate(this.ctx),this.poolBalls.forEach((function(t){t.animate(i.ctx)})),this.drawGameStatus();var e=this.canvas.getBoundingClientRect(),n=t.clientX-e.left*(this.canvas.width/e.width),s=t.clientY-e.top*(this.canvas.height/e.height);this.ctx.beginPath(),this.ctx.moveTo(this.poolBalls[0].x,this.poolBalls[0].y),this.ctx.lineTo(n,s),this.ctx.closePath(),this.ctx.lineWidth=7,this.ctx.strokeStyle="maroon",this.ctx.stroke(),this.poolBalls[0].animate(this.ctx),this.canvas.addEventListener("click",this.handleClick)}},{key:"takeTurn",value:function(){this.canvas.addEventListener("mousemove",this.handleMouseMove)}},{key:"drawGameStatus",value:function(){var t=this;this.ctx.font="bold 36px sans-serif",this.ctx.textAlign="center",this.ctx.fillStyle="rgb(64,64,64)",this.ctx.fillText(this.gameStatus,this.dimensions.width/2,135);var i=a;this.ctx.font="18px sans-serif",this.ctx.textAlign="left",this.ctx.fillStyle="rgb(64,64,64)",this.ctx.fillText("Player 1's Pocketed Balls".concat(this.playerOne.marking?" (".concat(this.playerOne.marking,")"):""),150,this.dimensions.height-112.5),this.ctx.fillStyle="thistle",this.ctx.fillRect(150,this.dimensions.height-105,.45*(this.dimensions.width-300),37.5),this.playerOne.marking&&this.pocketedBalls[this.playerOne.marking].forEach((function(e,n){e.x=150+5*(n+1)+(2*n+1)*i,e.y=t.dimensions.height-105+18.75,e.vx=0,e.vy=0,e.drawBall(t.ctx)})),this.ctx.font="18px sans-serif",this.ctx.textAlign="right",this.ctx.fillStyle="rgb(64,64,64)",this.ctx.fillText("Player 2's Pocketed Balls".concat(this.playerTwo.marking?" (".concat(this.playerTwo.marking,")"):""),this.dimensions.width-150,this.dimensions.height-112.5),this.ctx.fillStyle="thistle",this.ctx.fillRect(this.dimensions.width-150-.45*(this.dimensions.width-300),this.dimensions.height-105,.45*(this.dimensions.width-300),37.5),this.playerTwo.marking&&this.pocketedBalls[this.playerTwo.marking].forEach((function(e,n){e.x=t.dimensions.width-(150+5*(n+1)+(2*n+1)*i),e.y=t.dimensions.height-105+18.75,e.vx=0,e.vy=0,e.drawBall(t.ctx)}))}},{key:"checkCollisions",value:function(){this.poolBalls.forEach((function(t){return t.colliding=!1}));for(var t=0;t<this.poolBalls.length;t++)for(var i=t+1;i<this.poolBalls.length;i++)this.poolBalls[t].intersect(this.poolBalls[i])&&(this.poolBalls[t].colliding=!0,this.poolBalls[i].colliding=!0,0===t&&this.currentPlayer.marking&&null===this.scratched&&(this.poolBalls[i].marking!=this.currentPlayer.marking||"8"===this.poolBalls[i].number&&this.pocketedBalls[this.currentPlayer.marking].length<7?this.scratched=!0:this.scratched=!1),this.updateSpeed(this.poolBalls[t],this.poolBalls[i]))}},{key:"checkPocketsAndBoundary",value:function(){var t=this;this.poolBalls.forEach((function(i,e){var n=t.isNearPocket(i),s=a;t.isPocketed(i)?(i.vx=0,i.vy=0,t.currentPocketed.push(i),t.poolBalls[e]=null):n?n.forEach((function(t){switch(t.dir){case"bottomLeft":if(Math.abs(i.y+s/Math.sqrt(2)+t.slope*(i.x-s/Math.sqrt(2))-t.intercept)<5){var e=[i.vy,i.vx];i.vx=e[0],i.vy=e[1]}break;case"bottomRight":if(Math.abs(i.y+s/Math.sqrt(2)+t.slope*(i.x+s/Math.sqrt(2))-t.intercept)<5){var n=[-i.vy,-i.vx];i.vx=n[0],i.vy=n[1]}break;case"topLeft":if(Math.abs(i.y-s/Math.sqrt(2)+t.slope*(i.x-s/Math.sqrt(2))-t.intercept)<5){var r=[-i.vy,-i.vx];i.vx=r[0],i.vy=r[1]}break;case"topRight":if(Math.abs(i.y-s/Math.sqrt(2)+t.slope*(i.x+s/Math.sqrt(2))-t.intercept)<5){var o=[i.vy,i.vx];i.vx=o[0],i.vy=o[1]}}})):((i.x-a-.5<=t.innerTopLeft[0]+8||i.x+a+.5>=t.innerBottomRight[0]-8)&&(i.vx=-i.vx),(i.y-a-.5<=t.innerTopLeft[1]+8||i.y+a+.5>=t.innerBottomRight[1]-8)&&(i.vy=-i.vy))})),this.poolBalls=this.poolBalls.filter((function(t){return t}))}},{key:"isNearPocket",value:function(t){var i=this.innerTopLeft[0]+8+21,e=this.innerTopLeft[1]+8+21,n=this.innerBottomRight[0]-8-21,s=this.innerBottomRight[1]-8-21,r=.5*this.dimensions.width-14-16,o=.5*this.dimensions.width+14+16;return t.x<i&&t.y<e?[{slope:-1,intercept:21,dir:"bottomLeft"},{slope:-1,intercept:-21,dir:"topRight"}]:t.x<i&&t.y>s?[{slope:1,intercept:this.dimensions.height-21,dir:"topLeft"},{slope:1,intercept:this.dimensions.height+21,dir:"bottomRight"}]:t.x>n&&t.y<e?[{slope:1,intercept:this.dimensions.width-21,dir:"topLeft"},{slope:1,intercept:this.dimensions.width+21,dir:"bottomRight"}]:t.x>n&&t.y>s?[{slope:-1,intercept:this.dimensions.height-this.dimensions.width-21,dir:"topRight"},{slope:-1,intercept:this.dimensions.height-this.dimensions.width+21,dir:"bottomLeft"}]:t.y<=e+a&&t.x>r&&t.x<o?[{slope:1,intercept:.5*this.dimensions.width-14+150+32,dir:"topLeft"},{slope:-1,intercept:182-(.5*this.dimensions.width+14),dir:"topRight"}]:t.y>=s-a&&t.x>r&&t.x<o?[{slope:-1,intercept:this.dimensions.height-150-32-(.5*this.dimensions.width-14),dir:"bottomLeft"},{slope:1,intercept:.5*this.dimensions.width+14+this.dimensions.height-150-32,dir:"bottomRight"}]:null}},{key:"isPocketed",value:function(t){return this.table.pocketCenters.some((function(i){return(i[0]-t.x)*(i[0]-t.x)+(i[1]-t.y)*(i[1]-t.y)<=i[2]*i[2]}))}},{key:"updateSpeed",value:function(t,i){var e=i.x-t.x,n=i.y-t.y,s=Math.sqrt(e*e+n*n),r=e/s,o=n/s,h=r*(t.vx-i.vx)+o*(t.vy-i.vy);h<0||(t.vx-=r*h,t.vy-=o*h,i.vx+=r*h,i.vy+=o*h)}},{key:"rackPoolBalls",value:function(){var t=this.innerTopLeft[0]+.75*this.innerWidthHeight[0],i=this.innerTopLeft[1]+.5*this.innerWidthHeight[1],e=[{x:this.innerTopLeft[0]+.25*this.innerWidthHeight[0],y:i}];u(Array(5).keys()).forEach((function(n){return u(Array(n+1).keys()).forEach((function(s){var r=t+n*a*Math.sqrt(3),o=i-n*a+2*s*a;e.push({x:r,y:o})}))}));var n={x:0,y:0},s=[];s[0]=new d(e[0],{x:0,y:0},f[0].number,f[0].color,f[0].marking),s[5]=new d(e[5],n,f[8].number,f[8].color,f[8].marking);var r=f.slice(1,8),o=f.slice(9),h=Math.floor(Math.random()*r.length),l=Math.floor(Math.random()*o.length);s[11]=new d(e[11],n,r[h].number,r[h].color,r[h].marking),s[15]=new d(e[15],n,o[l].number,o[l].color,o[l].marking),r.splice(h,1),o.splice(l,1);var c=r.concat(o);return e.forEach((function(t,i){if(!s[i]){var e=Math.floor(Math.random()*c.length),r=new d(t,n,c[e].number,c[e].color,c[e].marking);s[i]=r,c.splice(e,1)}})),s}},{key:"restart",value:function(){this.running=!1,this.table=new o(this.dimensions),this.poolBalls=this.rackPoolBalls(),this.pocketedBalls={striped:[],solid:[]},this.currentPocketed=[],this.playerOne={id:1,marking:null},this.playerTwo={id:2,marking:null},this.currentPlayer=this.playerOne,this.gameStatus=null,this.newGame=!0,this.scratched=null,this.animate()}},{key:"play",value:function(){this.running=!0,this.animate()}}])&&y(i.prototype,e),n&&y(i,n),t}();document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("pool-game"),i=new p(t);i.restart(),document.getElementById("restart-game").addEventListener("click",(function(t){i.restart()}))}))}]);
//# sourceMappingURL=main.js.map